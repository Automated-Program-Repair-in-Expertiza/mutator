# mutator

### Prerequisite
 Git clone this repo and [mutant_rails_app](https://github.com/Automated-Program-Repair-in-Expertiza/mutant_rails_app) under same directory, run

 ```
 git clone https://github.com/Automated-Program-Repair-in-Expertiza/mutant_rails_app.git &&  bundle install
 cd ..
 git clone https://github.com/Automated-Program-Repair-in-Expertiza/mutator.git && bundle install
 ```
 
### File Structure
```
.
├── lib
│   ├── folder_path.yml
│   ├── method_finder.rb
│   ├── mutator.rb
│   ├── mutator_inputs_generator.rb
│   ├── mutator_outputs_separator.rb
│   ├── mutator_validator.rb
│   ├── run.sh
│   └── string.rb
└── results
    ├── fault_localization.yml
    ├── mutator-inputs
    ├── mutator-outputs
    ├── mutator-splitted-new-methods
    └── test-results
```

- Folder `lib` is created to store all kinds of scripts used to do automated-program-repair.
  - File `folder_path.yml` stores all frequently-used directory paths.
  - File `method_finder.rb` is used to accept a file path and line number and return the method that containing certain line of code.
  - Script `mutator.rb` uses [mutant gem](https://github.com/mbj/mutant) to mutate original method into several new mutant methods.
  - Script `mutator_inputs_generator.rb` generates a new file (input file of `mutator.rb`) only containing class declaration and buggy method block for each runtime exception error.
  - Script `mutator_outputs_separator.rb` separates outputs generated by `mutator.rb` and created mutator files. Each mutator file includes one mutant method.
  - Script `mutator_validator.rb` validates each mutant method by replacing buggy method with it and running test cases.
  - Script `run.sh` includes all commands. You can run `bash run.sh` to start the whole mutator process. (Have to git clone [mutant_rails_app](https://github.com/Automated-Program-Repair-in-Expertiza/mutant_rails_app) into same directory as mutator first)
  - File `string.rb` monkey-patches rails' `underscore` and `camelize` into String manually, instead of install ActiveSupport.
- Folder `results` stores all intermediate and final results.
  - File `fault_localization.yml` stores the id, buggy file, line number, test case information of each runtime exception error.
  - Folder `mutator-inputs` stores the results of `mutator_inputs_generator.rb` script.
  - Folder `mutator-outputs` stores the results of `mutator.rb` script.
  - Folder `mutator-splitted-new-methods` stores the results of `mutator_outputs_separator.rb` script.
  - File `test-results` store the final validated results of `mutator_validator.rb` script.
